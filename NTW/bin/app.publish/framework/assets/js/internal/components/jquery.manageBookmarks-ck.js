/*global define *//*jshint unused: false*/(function(e){typeof define=="function"&&define.amd?define(["jquery","service/bookmarksApi","helpers/common","libs/jquery/jquery-ui-1.10.3.mybusiness.min","modules/jquery.toggleManage"],e):window.jQuery&&window.BookmarksApi&&e(window.jQuery,window.BookmarksApi)})(function(e,t,n){e.fn.bookmarks=function(r){function u(e){alert("There was an error: "+e)}var i={userId:854193,orgId:13757},s={customForm:".tsShortCuts-add-url",customAddButton:"#add_bookmark",customAddUrl:"#shortcuts_url",customAddName:"#shortcuts_url_name",list:".tsShortCuts-links"},o=e.extend({},n,s,r),a=function(n,r){function s(t){var s=t[0].stBookmarkId,o=e("<li></li>"),u=e("<a href='"+r+"' title='"+n+"'></a>").text(n),a=e("<i style='display: inline;' class='tsIcon-Delete tsShortCuts-deleteBookmark tsToggle-container tsShortCuts-hide tsShortCuts-deleteBookmark' data-name='"+n+"' data-url='"+r+"' data-id='"+s+"'></i>");u.append(a);o.append(u);e("#toggle-add",i).before(o);l.call(i)}var i=this;t.addCorpBookMark(n,r,o.userId,o.orgId,{callback:s,errorHandler:u})},f=function(e,n,r,i){function s(){i.remove()}t.deleteCorpBookMark(e,n,r,o.userId,o.orgId,{callback:s,errorHandler:u})},l=function(){var t=this;e(".tsShortCuts-deleteBookmark",this).each(function(){var n=e._data(this,"events");(typeof n=="undefined"||!n.click)&&e(this).on("click",function(n){n.preventDefault();var r=e(this).parent().parent();f.call(t,e(this).attr("data-name"),e(this).attr("data-url"),e(this).attr("data-id"),r)})})},c=function(){var n=e(this),r=this;e(o.customAddButton,this).click(function(t){t.preventDefault();e(o.customForm).valid()&&e(o.customAddUrl,n).val().length>0&&(e(o.customAddName,n).val()==="undefined"?a.call(r,e(o.customAddUrl,n).val(),e(o.customAddUrl,n).val()):a.call(r,e(o.customAddName,n).val(),e(o.customAddUrl,n).val()))});e(".tsShortCuts-manage",this).tsToggle({target:".tsToggle-container",onToggle:function(t){e(o.list).sortable(t?"enable":"disable")}});e(".tsShortCuts-add-link",this).tsToggle({target:".tsExpand-container"});e(".tsShortCuts-add-btn",this).on("click",function(t){t.preventDefault();a.call(r,e(this).attr("data-name"),e(this).attr("data-url"))});e(o.list,this).sortable({items:"> li:not(.pin)",stop:function(r,i){var s=e.map(e(".tsShortCuts-links li a i",n),function(t){return e(t).data("id")}).join(",");t.updateCorpBookMark(o.userId,o.orgId,s,{callback:function(){},errorHandler:u})}}).disableSelection();e(o.list).sortable("disable")};return this.each(function(){if(!this.Bookmarks){this.Bookmarks={};c.call(this);l.call(this)}})};e(".tsShortCuts").bookmarks()});